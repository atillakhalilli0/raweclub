<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom T-Shirt Designer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white">
    <!-- Navigation -->
    <nav class="border-b border-gray-200 sticky top-0 bg-white z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-8">
                    <div class="text-2xl font-extrabold">RAWECLUB</div>
                    <div class="hidden md:flex space-x-6">
                        <a href="#" class="text-sm font-medium hover:text-gray-600">Men</a>
                        <a href="#" class="text-sm font-medium hover:text-gray-600">Women</a>
                        <a href="#" class="text-sm font-medium hover:text-gray-600">Kids</a>
                        <a href="#" class="text-sm font-medium hover:text-gray-600">Collections</a>
                    </div>
                </div>
                <div class="flex items-center space-x-6">
                    <button class="text-sm font-medium hover:text-gray-600">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </button>
                    <button class="text-sm font-medium hover:text-gray-600">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="bg-gray-50 py-6 lg:py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h1 class="text-3xl lg:text-6xl font-bold tracking-tight mb-2 lg:mb-4">DESIGN. CREATE. WEAR.</h1>
                <p class="text-sm lg:text-xl text-gray-600 max-w-2xl mx-auto">Create your own style. Upload your photo, customize it, and bring your unique design to life.</p>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 lg:py-12">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 lg:gap-12">
            <!-- Canvas Area -->
            <div class="lg:col-span-2">
                <div class="bg-gray-50 rounded-lg p-4 lg:p-8 flex items-center justify-center">
                    <div id="canvasContainer" class="w-full flex justify-center">
                        <canvas id="canvas"></canvas>
                    </div>
                </div>
                
                <!-- Mobile Action Buttons -->
                <div class="mt-4 grid grid-cols-2 gap-3 lg:hidden">
                    <button onclick="downloadDesign()" class="bg-black text-white py-3 rounded-full font-medium hover:bg-gray-800 transition-colors text-sm">
                        Download
                    </button>
                    <button onclick="clearCanvas()" class="border-2 border-black py-3 rounded-full font-medium hover:bg-gray-50 transition-colors text-sm">
                        Clear All
                    </button>
                </div>
            </div>

            <!-- Controls Sidebar -->
            <div class="lg:col-span-1">
                <div class="lg:sticky lg:top-24 space-y-4">
                    <!-- Upload Section -->
                    <div>
                        <h2 class="text-xl lg:text-2xl font-bold mb-4">Create Your Design</h2>
                        
                        <div class="space-y-3">
                            <div>
                                <label class="block text-xs font-semibold mb-2 tracking-wide">UPLOAD PHOTO</label>
                                <div class="relative">
                                    <input type="file" id="imageUpload" accept="image/*" class="hidden">
                                    <label for="imageUpload" class="block w-full bg-black text-white text-center py-3 rounded-full font-medium cursor-pointer hover:bg-gray-800 transition-colors text-sm">
                                        Choose File
                                    </label>
                                </div>
                            </div>

                            <!-- Side Selection -->
                            <div>
                                <label class="block text-xs font-semibold mb-2 tracking-wide">T-SHIRT VIEW</label>
                                <div class="grid grid-cols-2 gap-2">
                                    <button onclick="switchSide('front')" id="frontBtn" class="py-2.5 border-2 border-black bg-black text-white rounded-full font-medium transition-all text-sm">
                                        Front
                                    </button>
                                    <button onclick="switchSide('back')" id="backBtn" class="py-2.5 border-2 border-gray-300 bg-white text-black rounded-full font-medium hover:border-black transition-all text-sm">
                                        Back
                                    </button>
                                </div>
                            </div>

                            <!-- Color Selection -->
                            <div>
                                <label class="block text-xs font-semibold mb-2 tracking-wide">T-SHIRT COLOR</label>
                                <div class="grid grid-cols-5 gap-2">
                                    <button onclick="changeColor('#FFFFFF')" class="w-10 h-10 lg:w-12 lg:h-12 rounded-full border-2 border-gray-300 bg-white hover:scale-110 transition-transform"></button>
                                    <button onclick="changeColor('#000000')" class="w-10 h-10 lg:w-12 lg:h-12 rounded-full border-2 border-gray-300 bg-black hover:scale-110 transition-transform"></button>
                                    <button onclick="changeColor('#1E40AF')" class="w-10 h-10 lg:w-12 lg:h-12 rounded-full border-2 border-gray-300 bg-blue-800 hover:scale-110 transition-transform"></button>
                                    <button onclick="changeColor('#DC2626')" class="w-10 h-10 lg:w-12 lg:h-12 rounded-full border-2 border-gray-300 bg-red-600 hover:scale-110 transition-transform"></button>
                                    <button onclick="changeColor('#059669')" class="w-10 h-10 lg:w-12 lg:h-12 rounded-full border-2 border-gray-300 bg-emerald-600 hover:scale-110 transition-transform"></button>
                                    <button onclick="changeColor('#7C3AED')" class="w-10 h-10 lg:w-12 lg:h-12 rounded-full border-2 border-gray-300 bg-violet-600 hover:scale-110 transition-transform"></button>
                                    <button onclick="changeColor('#EA580C')" class="w-10 h-10 lg:w-12 lg:h-12 rounded-full border-2 border-gray-300 bg-orange-600 hover:scale-110 transition-transform"></button>
                                    <button onclick="changeColor('#EC4899')" class="w-10 h-10 lg:w-12 lg:h-12 rounded-full border-2 border-gray-300 bg-pink-500 hover:scale-110 transition-transform"></button>
                                    <button onclick="changeColor('#FCD34D')" class="w-10 h-10 lg:w-12 lg:h-12 rounded-full border-2 border-gray-300 bg-yellow-300 hover:scale-110 transition-transform"></button>
                                    <button onclick="changeColor('#6B7280')" class="w-10 h-10 lg:w-12 lg:h-12 rounded-full border-2 border-gray-300 bg-gray-500 hover:scale-110 transition-transform"></button>
                                </div>
                            </div>

                            <!-- Edit Controls -->
                            <div class="pt-3 border-t border-gray-200">
                                <label class="block text-xs font-semibold mb-2 tracking-wide">EDIT</label>
                                <div class="grid grid-cols-2 gap-2">
                                    <button onclick="centerImage()" class="py-2.5 border border-gray-300 rounded-full font-medium hover:bg-gray-50 transition-colors text-xs">
                                        Center
                                    </button>
                                    <button onclick="deleteSelected()" class="py-2.5 border border-gray-300 rounded-full font-medium hover:bg-gray-50 transition-colors text-xs">
                                        Delete
                                    </button>
                                </div>
                            </div>

                            <!-- Desktop Action Buttons -->
                            <div class="hidden lg:block pt-3 space-y-2">
                                <button onclick="downloadDesign()" class="w-full bg-black text-white py-3 rounded-full font-medium hover:bg-gray-800 transition-colors text-sm">
                                    Download Design
                                </button>
                                <button onclick="clearCanvas()" class="w-full border-2 border-black py-3 rounded-full font-medium hover:bg-gray-50 transition-colors text-sm">
                                    Clear All
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Tips -->
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="font-semibold mb-2 text-sm">Design Tips</h3>
                        <ul class="text-xs text-gray-600 space-y-1.5">
                            <li>â€¢ Drag to move your photo</li>
                            <li>â€¢ Resize from corners</li>
                            <li>â€¢ Rotate using top handle</li>
                            <li>â€¢ Press Delete to remove</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Features Section -->
    <div class="bg-gray-50 py-12 lg:py-16 mt-8 lg:mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="text-center">
                    <div class="text-3xl mb-3">ðŸŽ¨</div>
                    <h3 class="font-bold mb-2 text-sm lg:text-base">Unique Design</h3>
                    <p class="text-xs lg:text-sm text-gray-600">Create one-of-a-kind designs</p>
                </div>
                <div class="text-center">
                    <div class="text-3xl mb-3">âš¡</div>
                    <h3 class="font-bold mb-2 text-sm lg:text-base">Fast & Easy</h3>
                    <p class="text-xs lg:text-sm text-gray-600">Design in minutes</p>
                </div>
                <div class="text-center">
                    <div class="text-3xl mb-3">ðŸ’¯</div>
                    <h3 class="font-bold mb-2 text-sm lg:text-base">Premium Quality</h3>
                    <p class="text-xs lg:text-sm text-gray-600">High-quality guaranteed</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="border-t border-gray-200 mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-12">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 lg:gap-8">
                <div>
                    <h4 class="font-bold mb-3 text-sm">Products</h4>
                    <ul class="space-y-2 text-xs lg:text-sm text-gray-600">
                        <li><a href="#" class="hover:text-black">T-Shirts</a></li>
                        <li><a href="#" class="hover:text-black">Sweatshirts</a></li>
                        <li><a href="#" class="hover:text-black">Hoodies</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-3 text-sm">Support</h4>
                    <ul class="space-y-2 text-xs lg:text-sm text-gray-600">
                        <li><a href="#" class="hover:text-black">Contact</a></li>
                        <li><a href="#" class="hover:text-black">FAQ</a></li>
                        <li><a href="#" class="hover:text-black">Shipping</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-3 text-sm">Company</h4>
                    <ul class="space-y-2 text-xs lg:text-sm text-gray-600">
                        <li><a href="#" class="hover:text-black">About Us</a></li>
                        <li><a href="#" class="hover:text-black">Careers</a></li>
                        <li><a href="#" class="hover:text-black">Blog</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-3 text-sm">Follow Us</h4>
                    <ul class="space-y-2 text-xs lg:text-sm text-gray-600">
                        <li><a href="#" class="hover:text-black">Instagram</a></li>
                        <li><a href="#" class="hover:text-black">Twitter</a></li>
                        <li><a href="#" class="hover:text-black">Facebook</a></li>
                    </ul>
                </div>
            </div>
            <div class="mt-8 pt-6 border-t border-gray-200 text-center text-xs lg:text-sm text-gray-600">
                <p>&copy; 2025 RAWECLUB. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        let canvas;
        let tshirtTemplate = null;
        let currentSide = 'front';
        let currentColor = '#FFFFFF';
        let frontObjects = [];
        let backObjects = [];
        let isLoadingTemplate = false;

        // Initialize canvas with proper sizing
        function initCanvas() {
            const container = document.getElementById('canvasContainer');
            const containerWidth = container.offsetWidth;
            
            // Set canvas size based on screen
            let canvasWidth, canvasHeight;
            if (window.innerWidth < 1024) {
                // Mobile: use full container width
                canvasWidth = Math.min(containerWidth, 400);
                canvasHeight = canvasWidth * 1.2;
            } else {
                // Desktop: fixed size
                canvasWidth = 500;
                canvasHeight = 600;
            }
            
            canvas = new fabric.Canvas('canvas', {
                width: canvasWidth,
                height: canvasHeight,
                backgroundColor: '#f9fafb'
            });
            
            createTshirtTemplate();
        }

        // Reinitialize on resize
        let resizeTimeout;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(function() {
                const container = document.getElementById('canvasContainer');
                const containerWidth = container.offsetWidth;
                
                let canvasWidth, canvasHeight;
                if (window.innerWidth < 1024) {
                    canvasWidth = Math.min(containerWidth, 400);
                    canvasHeight = canvasWidth * 1.2;
                } else {
                    canvasWidth = 500;
                    canvasHeight = 600;
                }
                
                canvas.setWidth(canvasWidth);
                canvas.setHeight(canvasHeight);
                
                // Reload template with new size
                createTshirtTemplate();
            }, 250);
        });

        // Load T-shirt template
        function createTshirtTemplate(side = 'front', callback) {
            if (isLoadingTemplate) return;
            isLoadingTemplate = true;

            const imagePath = side === 'front' ? './img/white-shirt.png' : './img/back-side.png';
            
            fabric.Image.fromURL(imagePath, function(img) {
                if (!img || !img.width) {
                    console.error('Failed to load image:', imagePath);
                    isLoadingTemplate = false;
                    return;
                }

                const scale = Math.min(
                    canvas.width / img.width,
                    canvas.height / img.height
                ) * 0.85;
                
                img.scale(scale);
                img.set({
                    left: canvas.width / 2,
                    top: canvas.height / 2,
                    originX: 'center',
                    originY: 'center',
                    selectable: false,
                    evented: false
                });
                
                if (tshirtTemplate) {
                    canvas.remove(tshirtTemplate);
                }
                
                tshirtTemplate = img;
                applyColorToTemplate(currentColor);
                
                canvas.add(tshirtTemplate);
                canvas.sendToBack(tshirtTemplate);
                canvas.renderAll();
                
                isLoadingTemplate = false;
                
                if (callback) callback();
            }, { crossOrigin: 'anonymous' });
        }

        // Apply color filter
        function applyColorToTemplate(color) {
            if (!tshirtTemplate) return;
            
            tshirtTemplate.filters = [];
            
            if (color !== '#FFFFFF') {
                tshirtTemplate.filters.push(new fabric.Image.filters.BlendColor({
                    color: color,
                    mode: 'tint',
                    alpha: 0.83
                }));
            }
            
            tshirtTemplate.applyFilters();
        }

        // Side switch
        function switchSide(side) {
            if (isLoadingTemplate || currentSide === side) return;

            const currentObjects = canvas.getObjects().filter(obj => obj !== tshirtTemplate);
            const serializedObjects = currentObjects.map(obj => obj.toObject(['selectable', 'evented', 'cornerColor', 'cornerSize', 'transparentCorners', 'borderColor', 'cornerStyle']));
            
            if (currentSide === 'front') {
                frontObjects = serializedObjects;
            } else {
                backObjects = serializedObjects;
            }

            canvas.getObjects().forEach(obj => {
                if (obj !== tshirtTemplate) {
                    canvas.remove(obj);
                }
            });

            currentSide = side;

            createTshirtTemplate(side, function() {
                const objectsToLoad = side === 'front' ? frontObjects : backObjects;
                
                objectsToLoad.forEach(objData => {
                    fabric.Image.fromObject(objData, function(img) {
                        img.set({
                            cornerColor: '#000',
                            cornerSize: 10,
                            transparentCorners: false,
                            borderColor: '#000',
                            cornerStyle: 'circle'
                        });
                        canvas.add(img);
                    });
                });
                
                canvas.renderAll();
            });

            const frontBtn = document.getElementById('frontBtn');
            const backBtn = document.getElementById('backBtn');
            
            if (side === 'front') {
                frontBtn.className = 'py-2.5 border-2 border-black bg-black text-white rounded-full font-medium transition-all text-sm';
                backBtn.className = 'py-2.5 border-2 border-gray-300 bg-white text-black rounded-full font-medium hover:border-black transition-all text-sm';
            } else {
                backBtn.className = 'py-2.5 border-2 border-black bg-black text-white rounded-full font-medium transition-all text-sm';
                frontBtn.className = 'py-2.5 border-2 border-gray-300 bg-white text-black rounded-full font-medium hover:border-black transition-all text-sm';
            }
        }

        // Photo upload
        document.getElementById('imageUpload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    fabric.Image.fromURL(event.target.result, function(img) {
                        const maxWidth = canvas.width * 0.4;
                        img.scaleToWidth(maxWidth);
                        img.set({
                            left: canvas.width / 2,
                            top: canvas.height / 2,
                            originX: 'center',
                            originY: 'center',
                            cornerColor: '#000',
                            cornerSize: 10,
                            transparentCorners: false,
                            borderColor: '#000',
                            cornerStyle: 'circle'
                        });
                        canvas.add(img);
                        canvas.setActiveObject(img);
                        canvas.renderAll();
                    });
                };
                reader.readAsDataURL(file);
            }
            e.target.value = '';
        });

        function changeColor(color) {
            currentColor = color;
            applyColorToTemplate(color);
            canvas.renderAll();
        }

        function centerImage() {
            const activeObject = canvas.getActiveObject();
            if (activeObject && activeObject.type === 'image' && activeObject !== tshirtTemplate) {
                activeObject.set({
                    left: canvas.width / 2,
                    top: canvas.height / 2,
                    originX: 'center',
                    originY: 'center'
                });
                canvas.renderAll();
            } else {
                alert('Please select a photo first!');
            }
        }

        function deleteSelected() {
            const activeObject = canvas.getActiveObject();
            if (activeObject && activeObject !== tshirtTemplate) {
                canvas.remove(activeObject);
                canvas.renderAll();
            }
        }

        function clearCanvas() {
            const objects = canvas.getObjects();
            objects.forEach(obj => {
                if (obj !== tshirtTemplate) {
                    canvas.remove(obj);
                }
            });
            
            if (currentSide === 'front') {
                frontObjects = [];
            } else {
                backObjects = [];
            }
            
            canvas.renderAll();
        }

        function downloadDesign() {
            canvas.discardActiveObject();
            canvas.renderAll();
            
            const dataURL = canvas.toDataURL({
                format: 'png',
                quality: 1,
                multiplier: 2
            });
            
            const link = document.createElement('a');
            link.download = `raweclub-tshirt-${currentSide}.png`;
            link.href = dataURL;
            link.click();
        }

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Delete' || e.key === 'Backspace') {
                const activeElement = document.activeElement;
                if (activeElement.tagName !== 'INPUT' && activeElement.tagName !== 'TEXTAREA') {
                    e.preventDefault();
                    deleteSelected();
                }
            }
        });

        // Initialize
        initCanvas();
    </script>
</body>
</html>